# é–‹ç™¼ç’°å¢ƒé…ç½®è¦ç¯„

## ç’°å¢ƒå®šç¾©

æœ¬å°ˆæ¡ˆåƒ…æ”¯æ´å…©ç¨®æ¨™æº–åŒ–ç’°å¢ƒï¼Œæ‰€æœ‰é–‹ç™¼å·¥ä½œå‡é ˆåœ¨ä»¥ä¸‹ç’°å¢ƒä¸­é€²è¡Œï¼š

### ğŸ”§ é–‹ç™¼ç’°å¢ƒ (Development Environment)

- **å•Ÿå‹•æŒ‡ä»¤**ï¼š`npm run reset:dev`
- **ç”¨é€”**ï¼šæ—¥å¸¸é–‹ç™¼ã€æ¸¬è©¦ã€é™¤éŒ¯
- **ç‰¹è‰²**ï¼šå•Ÿç”¨é–‹ç™¼æ¨¡å¼ã€è©³ç´°æ—¥èªŒã€ç†±é‡è¼‰

### ğŸš€ æ­£å¼ç’°å¢ƒ (Production Environment)

- **å•Ÿå‹•æŒ‡ä»¤**ï¼š`npm run reset:prod`
- **ç”¨é€”**ï¼šæ­£å¼éƒ¨ç½²ã€æ•ˆèƒ½æ¸¬è©¦ã€æœ€çµ‚é©—è­‰
- **ç‰¹è‰²**ï¼šæœ€ä½³åŒ–å»ºç½®ã€ç”Ÿç”¢ç´šè¨­å®šã€æ•ˆèƒ½ç›£æ§

## Docker å®¹å™¨æ¶æ§‹

å…©ç¨®ç’°å¢ƒå‡é€é Docker å®¹å™¨åŒ–é‹è¡Œï¼ŒåŒ…å«ä»¥ä¸‹ä¸‰å€‹æ ¸å¿ƒå®¹å™¨ï¼š

### å®¹å™¨çµ„æˆ

1. **`app-dev`** - Next.js æ‡‰ç”¨ç¨‹å¼å®¹å™¨
2. **`mongo-express`** - MongoDB ç¶²é ç®¡ç†ä»‹é¢
3. **`mongo`** - MongoDB è³‡æ–™åº«ä¼ºæœå™¨

### å®¹å™¨é€£æ¥åŸ å°æ‡‰

- **æ‡‰ç”¨ç¨‹å¼**ï¼šhttp://localhost:3000
- **MongoDB Express**ï¼šhttp://localhost:8081
- **MongoDB ç›´é€£**ï¼šmongodb://localhost:27017

## ç’°å¢ƒé‡ç½®æµç¨‹

### `npm run reset` åŸ·è¡Œå…§å®¹

åŸ·è¡Œç’°å¢ƒé‡ç½®æ™‚ï¼Œç³»çµ±æœƒè‡ªå‹•åŸ·è¡Œä»¥ä¸‹æµç¨‹ï¼š

```bash
# reset:dev å¯¦éš›åŸ·è¡Œçš„æŒ‡ä»¤åºåˆ—ï¼š
npm run stop                    # åœæ­¢æ‰€æœ‰ Docker å®¹å™¨
npm run docker:purge           # Docker ç³»çµ±æ¸…ç†
npm run start:dev              # å•Ÿå‹•é–‹ç™¼ç’°å¢ƒå®¹å™¨ç¾¤çµ„
npm run db:full-restore        # å®Œæ•´è³‡æ–™åº«é‚„åŸèˆ‡ç´¢å¼•é‡å»º

# reset:prod å¯¦éš›åŸ·è¡Œçš„æŒ‡ä»¤åºåˆ—ï¼š
npm run stop                    # åœæ­¢æ‰€æœ‰ Docker å®¹å™¨
npm run docker:purge           # Docker ç³»çµ±æ¸…ç†
npm run start:prod             # å•Ÿå‹•æ­£å¼ç’°å¢ƒå®¹å™¨ç¾¤çµ„
npm run db:full-restore        # å®Œæ•´è³‡æ–™åº«é‚„åŸèˆ‡ç´¢å¼•é‡å»º
```

#### 1. åœæ­¢éšæ®µ (`npm run stop`)

- åœæ­¢æ‰€æœ‰ Docker å®¹å™¨

#### 2. æ¸…ç†éšæ®µ (`npm run docker:purge`)

```bash
# å¯¦éš›åŸ·è¡Œå…§å®¹ï¼š
docker compose down -v --remove-orphans  # ç§»é™¤å®¹å™¨ã€ç¶²è·¯ã€å·
docker system prune -a --volumes -f      # æ¸…ç† Docker ç³»çµ±å¿«å–
npm cache clean --force                   # æ¸…ç©º npm å¿«å–
```

#### 3. å•Ÿå‹•éšæ®µ (`npm run start:dev` / `npm run start:prod`)

```bash
# é–‹ç™¼ç’°å¢ƒï¼š
docker compose --profile dev --profile tools up -d

# æ­£å¼ç’°å¢ƒï¼š
docker compose --profile prod up -d
```

#### 4. è³‡æ–™åº«é‚„åŸéšæ®µ (`npm run db:full-restore`)

- åœ¨ Docker å®¹å™¨å•Ÿå‹•å®Œæˆå¾ŒåŸ·è¡Œ
- é€²è¡Œå®Œæ•´è³‡æ–™åº«é‚„åŸèˆ‡ç´¢å¼•é‡å»º

#### 5. èƒŒæ™¯æœå‹™åˆå§‹åŒ–ï¼ˆé€é `/app/scripts/entrypoint.sh`ï¼‰

å®¹å™¨å•Ÿå‹•å¾Œæœƒè‡ªå‹•åœ¨èƒŒæ™¯åŸ·è¡Œï¼š

```bash
npm run sitemap:monitor    # å•Ÿå‹•ç¶²ç«™åœ°åœ–ç›£æ§å™¨ï¼ˆèƒŒæ™¯åŸ·è¡Œï¼‰
npm run db:reset-keys      # å•Ÿå‹• API é‡‘é‘°æ¯æ—¥é‡ç½®æ’ç¨‹ï¼ˆèƒŒæ™¯åŸ·è¡Œï¼‰
```

## è³‡æ–™åº«é€£ç·šè¦ç¯„

### ğŸš¨ é‡è¦æé†’

è³‡æ–™åº«é€£ç·šå¿…é ˆåš´æ ¼éµå¾ªä»¥ä¸‹èªè­‰è³‡è¨Šï¼Œå¦å‰‡æœƒå°è‡´é€£ç·šå¤±æ•—ï¼š

### é€£ç·šå­—ä¸²æ ¼å¼

```bash
MONGODB_URI=mongodb://admin:password@localhost:27017/corp-insight?authSource=admin
```

### èªè­‰åƒæ•¸èªªæ˜

- **ä½¿ç”¨è€…åç¨±**ï¼š`admin`
- **å¯†ç¢¼**ï¼š`password`
- **ä¸»æ©Ÿä½å€**ï¼š`localhost`
- **é€£æ¥åŸ **ï¼š`27017`
- **è³‡æ–™åº«åç¨±**ï¼š`corp-insight`
- **èªè­‰ä¾†æº**ï¼š`admin`

### è¨­å®šæª”åƒè€ƒ

æ‰€æœ‰è³‡æ–™åº«é€£ç·šåƒæ•¸è«‹åƒç…§ï¼š`/projects/Corp-Insight/next/.env.example`

## AI Assistant æ‡‰å°è¦ç¯„

### ç’°å¢ƒè­˜åˆ¥é—œéµè©

ç•¶ä½¿ç”¨è€…æåŠä»¥ä¸‹è©å½™æ™‚ï¼ŒAI Assistant æ‡‰ç«‹å³è­˜åˆ¥å°æ‡‰ç’°å¢ƒï¼š

**é–‹ç™¼ç’°å¢ƒè§¸ç™¼è©**ï¼š

- é–‹ç™¼ç’°å¢ƒã€é–‹ç™¼æ¨¡å¼ã€dev ç’°å¢ƒ
- æ¸¬è©¦ç’°å¢ƒã€é™¤éŒ¯ç’°å¢ƒ
- `npm run reset:dev`

**æ­£å¼ç’°å¢ƒè§¸ç™¼è©**ï¼š

- æ­£å¼ç’°å¢ƒã€ç”Ÿç”¢ç’°å¢ƒã€prod ç’°å¢ƒ
- éƒ¨ç½²ç’°å¢ƒã€ä¸Šç·šç’°å¢ƒ
- `npm run reset:prod`

### æ¨™æº–åŒ–å›æ‡‰

AI Assistant æ‡‰ä½¿ç”¨çµ±ä¸€çš„ç’°å¢ƒæè¿°èˆ‡æŒ‡ä»¤å»ºè­°ï¼Œç¢ºä¿åœ˜éšŠæºé€šçš„ä¸€è‡´æ€§ã€‚

## æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

**å®¹å™¨å•Ÿå‹•å¤±æ•—**ï¼š

```bash
npm run reset:dev  # æˆ– reset:prod - å®Œæ•´é‡ç½®ç’°å¢ƒ
```

**è³‡æ–™åº«é€£ç·šå¤±æ•—**ï¼š

1. ç¢ºèª `.env` æª”æ¡ˆä½¿ç”¨æ­£ç¢ºçš„é€£ç·šå­—ä¸²
2. æª¢æŸ¥ MongoDB å®¹å™¨æ˜¯å¦æ­£å¸¸é‹è¡Œï¼š`docker ps`
3. é‡æ–°åŸ·è¡Œç’°å¢ƒé‡ç½®ï¼š`npm run reset:dev`

**åŸ è™Ÿè¡çª**ï¼š

```bash
# æª¢æŸ¥åŸ è™Ÿä½”ç”¨
netstat -tulpn | grep :3000
netstat -tulpn | grep :27017
netstat -tulpn | grep :8081

# å¼·åˆ¶åœæ­¢ä½”ç”¨çš„ç¨‹åºå¾Œé‡æ–°å•Ÿå‹•ç’°å¢ƒ
npm run reset:dev
```

**Docker å¿«å–å•é¡Œ**ï¼š

```bash
# docker:purge æœƒè‡ªå‹•æ¸…ç†ï¼Œä½†å¦‚ä»æœ‰å•é¡Œå¯æ‰‹å‹•åŸ·è¡Œï¼š
docker system prune -a --volumes -f
npm run start:dev
```

## é‡è¦æ¾„æ¸…

### âŒ ç’°å¢ƒé‡ç½® **ä¸æœƒ** åŸ·è¡Œä»¥ä¸‹å‹•ä½œï¼š

- **ä¸æœƒç§»é™¤** `node_modules` ç›®éŒ„
- **ä¸æœƒåŸ·è¡Œ** `npm install`
- **ä¸æœƒå½±éŸ¿** æœ¬æ©Ÿæª”æ¡ˆç³»çµ±çš„ Node.js ç›¸ä¾å¥—ä»¶

### âœ… ç’°å¢ƒé‡ç½® **åªæœƒ** å½±éŸ¿ï¼š

- Docker å®¹å™¨èˆ‡æ˜ åƒæª”
- Docker å·èˆ‡ç¶²è·¯è¨­å®š
- npm å¿«å–
- å®¹å™¨å…§çš„è³‡æ–™åº«ç‹€æ…‹

## ç’°å¢ƒç¶­è­·

### å®šæœŸç¶­è­·å»ºè­°

- **æ¯æ—¥é–‹ç™¼å‰**ï¼šåŸ·è¡Œ `npm run reset:dev` ç¢ºä¿ç’°å¢ƒä¹¾æ·¨
- **åŠŸèƒ½æ¸¬è©¦å‰**ï¼šåŸ·è¡Œ `npm run reset:prod` æ¨¡æ“¬æ­£å¼ç’°å¢ƒ
- **é€±æœŸæ€§æ¸…ç†**ï¼šç’°å¢ƒé‡ç½®å·²åŒ…å«å¿…è¦çš„æ¸…ç†å‹•ä½œ

### ç›£æ§æŒ‡æ¨™

- Docker å®¹å™¨å¥åº·ç‹€æ…‹
- è³‡æ–™åº«é€£ç·šç©©å®šæ€§
- æ‡‰ç”¨ç¨‹å¼å›æ‡‰æ™‚é–“
- ç³»çµ±è³‡æºä½¿ç”¨ç‡

---

**æœ€å¾Œæ›´æ–°**ï¼š2025-08-18
**ç¶­è­·è€…**ï¼šBMad Method Team
