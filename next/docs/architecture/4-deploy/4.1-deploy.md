# éƒ¨ç½²æ¶æ§‹

```mermaid
flowchart TD
    User["ğŸ‘¥ ä½¿ç”¨è€…"]

    subgraph Internet["ğŸŒ ç¶²éš›ç¶²è·¯å±¤"]
        CDN["Cloudflare CDN<br/>(å¯é¸)"]
    end

    subgraph EdgeLayer["ğŸ”’ é‚Šç·£å±¤"]
        Nginx["Nginx<br/>åå‘ä»£ç†<br/>- SSL çµ‚æ­¢<br/>- è² è¼‰å‡è¡¡<br/>- éœæ…‹è³‡æº"]
    end

    subgraph EC2["â˜ï¸ AWS EC2 Instance"]
        direction TB

        subgraph PM2Layer["ğŸ”„ PM2 é€²ç¨‹ç®¡ç†"]
            direction LR
            PM2Main["app-main<br/>(ä¸»ç«™)<br/>corpinsight.leopilot.com"]
            PM2AITools["app-aitools<br/>(AI å·¥å…·ç«™)<br/>aitools.leopilot.com"]
        end

        subgraph DockerLayer["ğŸ³ Docker Compose"]
            direction LR
            MongoDB["MongoDB Container<br/>- è³‡æ–™æŒä¹…åŒ–<br/>- å¥åº·æª¢æŸ¥<br/>- è‡ªå‹•é‡å•Ÿ"]
            MongoExpress["Mongo Express<br/>(è³‡æ–™åº«ç®¡ç†ä»‹é¢)"]
        end

        subgraph AppLayer["ğŸ“¦ æ‡‰ç”¨ç¨‹å¼å±¤"]
            NextApp["Next.js 14 æ‡‰ç”¨<br/>- SSR/SSG<br/>- API Routes<br/>- ä¸­ä»‹å±¤"]
        end
    end

    subgraph ExternalServices["ğŸ”Œ å¤–éƒ¨æœå‹™"]
        GeminiAPI["Google Generative AI<br/>(Gemini 2.5 Flash)"]
        G0VAPI["G0V ä¼æ¥­è³‡æ–™ API"]
        TenderAPI["æ”¿åºœæ¨™æ¡ˆ API"]
        RedisCloud["Redis<br/>(Sitemap å¿«å–)"]
    end

    User --> CDN
    CDN --> Nginx
    User -.ç›´é€£.-> Nginx

    Nginx --> PM2Main
    Nginx --> PM2AITools

    PM2Main --> NextApp
    PM2AITools --> NextApp

    NextApp --> MongoDB
    NextApp --> MongoExpress
    NextApp --> GeminiAPI
    NextApp --> G0VAPI
    NextApp --> TenderAPI
    NextApp --> RedisCloud

    classDef userClass fill:#e8f5e9,stroke:#2e7d32,stroke-width:3px
    classDef cdnClass fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef proxyClass fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    classDef ec2Class fill:#f3e5f5,stroke:#6a1b9a,stroke-width:3px
    classDef pm2Class fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
    classDef dockerClass fill:#e0f2f1,stroke:#00695c,stroke-width:2px
    classDef appClass fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    classDef externalClass fill:#ffebee,stroke:#c62828,stroke-width:2px

    class User userClass
    class CDN cdnClass
    class Nginx proxyClass
    class EC2 ec2Class
    class PM2Layer,PM2Main,PM2AITools pm2Class
    class DockerLayer,MongoDB,MongoExpress dockerClass
    class AppLayer,NextApp appClass
    class ExternalServices,GeminiAPI,G0VAPI,TenderAPI,RedisCloud externalClass
```
